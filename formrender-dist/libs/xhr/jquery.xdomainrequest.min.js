/*!
 * jQuery-ajaxTransport-XDomainRequest - v1.0.1 - 2013-10-17
 * https://github.com/MoonScript/jQuery-ajaxTransport-XDomainRequest
 * Copyright (c) 2013 Jason Moon (@JSONMOON)
 * Licensed MIT (/blob/master/LICENSE.txt)
 */

!function(e){if(!e.support.cors&&e.ajaxTransport&&window.XDomainRequest){var t=/^https?:\/\//i,o=/^get|post$/i,n=new RegExp("^"+location.protocol,"i"),s=/text\/html/i,r=/\/json/i,a=/\/xml/i;e.ajaxTransport("* text html xml json",function(i,c,p){if(i.crossDomain&&i.async&&o.test(i.type)&&t.test(i.url)&&n.test(i.url)){var l=null,m=(c.dataType||"").toLowerCase();return{send:function(t,o){l=new XDomainRequest,/^\d+$/.test(c.timeout)&&(l.timeout=c.timeout),l.ontimeout=function(){o(500,"timeout")},l.onload=function(){var t="Content-Length: "+l.responseText.length+"\r\nContent-Type: "+l.contentType,n={code:200,message:"success"},i={text:l.responseText};try{if("html"===m||s.test(l.contentType))i.html=l.responseText;else if("json"===m||"text"!==m&&r.test(l.contentType))try{i.json=e.parseJSON(l.responseText)}catch(e){n.code=500,n.message="parseerror"}else if("xml"===m||"text"!==m&&a.test(l.contentType)){var c=new ActiveXObject("Microsoft.XMLDOM");c.async=!1;try{c.loadXML(l.responseText)}catch(e){c=void 0}if(!c||!c.documentElement||c.getElementsByTagName("parsererror").length)throw n.code=500,n.message="parseerror","Invalid XML: "+l.responseText;i.xml=c}}catch(e){throw e}finally{o(n.code,n.message,i,t)}},l.onprogress=function(){},l.onerror=function(){o(500,"error",{text:l.responseText})};var n="";c.data&&(n="string"===e.type(c.data)?c.data:e.param(c.data)),l.open(i.type,i.url),l.send(n)},abort:function(){l&&l.abort()}}}})}}(jQuery);