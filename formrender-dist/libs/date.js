/**
 * Copyright (c)2005-2009 Matt Kruse (javascripttoolbox.com)
 *
 * Dual licensed under the MIT and GPL licenses.
 * This basically means you can use this code however you want for
 * free, but don't claim to have written it yourself!
 * Donations always accepted: http://www.JavascriptToolbox.com/donate/
 *
 * Please do not link to the .js files on javascripttoolbox.com from
 * your site. Copy the files locally to your server instead.
 *
 */

Date.$VERSION=1.02,Date.LZ=function(e){return(e<0||e>9?"":"0")+e},Date.monthNames=new Array("January","February","March","April","May","June","July","August","September","October","November","December"),Date.monthAbbreviations=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),Date.dayNames=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"),Date.dayAbbreviations=new Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat"),Date.preferAmericanFormat=!0,Date.prototype.getFullYear||(Date.prototype.getFullYear=function(){var e=this.getYear();return e<1900?e+1900:e}),Date.parseString=function(e,t){if("undefined"==typeof t||null==t||""==t){for(var n=new Array("y-M-d","MMM d, y","MMM d,y","y-MMM-d","d-MMM-y","MMM d","MMM-d","d-MMM"),r=new Array("M/d/y","M-d-y","M.d.y","M/d","M-d"),i=new Array("d/M/y","d-M-y","d.M.y","d/M","d-M"),a=new Array(n,Date.preferAmericanFormat?r:i,Date.preferAmericanFormat?i:r),s=0;s<a.length;s++)for(var l=a[s],u=0;u<l.length;u++){var h=Date.parseString(e,l[u]);if(null!=h)return h}return null}this.isInteger=function(e){for(var t=0;t<e.length;t++)if("1234567890".indexOf(e.charAt(t))==-1)return!1;return!0},this.getInt=function(e,t,n,r){for(var i=r;i>=n;i--){var a=e.substring(t,t+i);if(a.length<n)return null;if(this.isInteger(a))return a}return null},e+="",t+="";for(var o,g,f=0,y=0,M="",d="",D=(new Date).getFullYear(),m=1,c=1,p=0,b=0,A=0,v="";y<t.length;){for(M=t.charAt(y),d="";t.charAt(y)==M&&y<t.length;)d+=t.charAt(y++);if("yyyy"==d||"yy"==d||"y"==d){if("yyyy"==d&&(o=4,g=4),"yy"==d&&(o=2,g=2),"y"==d&&(o=2,g=4),D=this.getInt(e,f,o,g),null==D)return null;f+=D.length,2==D.length&&(D=D>70?1900+(D-0):2e3+(D-0))}else if("MMM"==d||"NNN"==d){m=0;for(var w="MMM"==d?Date.monthNames.concat(Date.monthAbbreviations):Date.monthAbbreviations,s=0;s<w.length;s++){var N=w[s];if(e.substring(f,f+N.length).toLowerCase()==N.toLowerCase()){m=s%12+1,f+=N.length;break}}if(m<1||m>12)return null}else if("EE"==d||"E"==d)for(var w="EE"==d?Date.dayNames:Date.dayAbbreviations,s=0;s<w.length;s++){var T=w[s];if(e.substring(f,f+T.length).toLowerCase()==T.toLowerCase()){f+=T.length;break}}else if("MM"==d||"M"==d){if(m=this.getInt(e,f,d.length,2),null==m||m<1||m>12)return null;f+=m.length}else if("dd"==d||"d"==d){if(c=this.getInt(e,f,d.length,2),null==c||c<1||c>31)return null;f+=c.length}else if("hh"==d||"h"==d){if(p=this.getInt(e,f,d.length,2),null==p||p<1||p>12)return null;f+=p.length}else if("HH"==d||"H"==d){if(p=this.getInt(e,f,d.length,2),null==p||p<0||p>23)return null;f+=p.length}else if("KK"==d||"K"==d){if(p=this.getInt(e,f,d.length,2),null==p||p<0||p>11)return null;f+=p.length,p++}else if("kk"==d||"k"==d){if(p=this.getInt(e,f,d.length,2),null==p||p<1||p>24)return null;f+=p.length,p--}else if("mm"==d||"m"==d){if(b=this.getInt(e,f,d.length,2),null==b||b<0||b>59)return null;f+=b.length}else if("ss"==d||"s"==d){if(A=this.getInt(e,f,d.length,2),null==A||A<0||A>59)return null;f+=A.length}else if("a"==d){if("am"==e.substring(f,f+2).toLowerCase())v="AM";else{if("pm"!=e.substring(f,f+2).toLowerCase())return null;v="PM"}f+=2}else{if(e.substring(f,f+d.length)!=d)return null;f+=d.length}}if(f!=e.length)return null;if(2==m)if(D%4==0&&D%100!=0||D%400==0){if(c>29)return null}else if(c>28)return null;return(4==m||6==m||9==m||11==m)&&c>30?null:(p<12&&"PM"==v?p=p-0+12:p>11&&"AM"==v&&(p-=12),new Date(D,m-1,c,p,b,A))},Date.isValid=function(e,t){return null!=Date.parseString(e,t)},Date.prototype.isBefore=function(e){return null!=e&&this.getTime()<e.getTime()},Date.prototype.isAfter=function(e){return null!=e&&this.getTime()>e.getTime()},Date.prototype.equals=function(e){return null!=e&&this.getTime()==e.getTime()},Date.prototype.equalsIgnoreTime=function(e){if(null==e)return!1;var t=new Date(this.getTime()).clearTime(),n=new Date(e.getTime()).clearTime();return t.getTime()==n.getTime()},Date.prototype.format=function(e){e+="";var t,n="",r=0,i="",a="",s=this.getYear()+"",l=this.getMonth()+1,u=this.getDate(),h=this.getDay(),t=this.getHours(),o=this.getMinutes(),g=this.getSeconds(),f=new Object;for(s.length<4&&(s=""+(+s+1900)),f.y=""+s,f.yyyy=s,f.yy=s.substring(2,4),f.M=l,f.MM=Date.LZ(l),f.MMM=Date.monthNames[l-1],f.NNN=Date.monthAbbreviations[l-1],f.d=u,f.dd=Date.LZ(u),f.E=Date.dayAbbreviations[h],f.EE=Date.dayNames[h],f.H=t,f.HH=Date.LZ(t),0==t?f.h=12:t>12?f.h=t-12:f.h=t,f.hh=Date.LZ(f.h),f.K=f.h-1,f.k=f.H+1,f.KK=Date.LZ(f.K),f.kk=Date.LZ(f.k),t>11?f.a="PM":f.a="AM",f.m=o,f.mm=Date.LZ(o),f.s=g,f.ss=Date.LZ(g);r<e.length;){for(i=e.charAt(r),a="";e.charAt(r)==i&&r<e.length;)a+=e.charAt(r++);n+="undefined"!=typeof f[a]?f[a]:a}return n},Date.prototype.getDayName=function(){return Date.dayNames[this.getDay()]},Date.prototype.getDayAbbreviation=function(){return Date.dayAbbreviations[this.getDay()]},Date.prototype.getMonthName=function(){return Date.monthNames[this.getMonth()]},Date.prototype.getMonthAbbreviation=function(){return Date.monthAbbreviations[this.getMonth()]},Date.prototype.clearTime=function(){return this.setHours(0),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),this},Date.prototype.add=function(e,t){if("undefined"==typeof e||null==e||"undefined"==typeof t||null==t)return this;if(t=+t,"y"==e)this.setFullYear(this.getFullYear()+t);else if("M"==e)this.setMonth(this.getMonth()+t);else if("d"==e)this.setDate(this.getDate()+t);else if("w"==e)for(var n=t>0?1:-1;0!=t;){for(this.add("d",n);0==this.getDay()||6==this.getDay();)this.add("d",n);t-=n}else"h"==e?this.setHours(this.getHours()+t):"m"==e?this.setMinutes(this.getMinutes()+t):"s"==e&&this.setSeconds(this.getSeconds()+t);return this};