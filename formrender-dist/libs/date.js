/**
 * Copyright (c)2005-2009 Matt Kruse (javascripttoolbox.com)
 *
 * Dual licensed under the MIT and GPL licenses.
 * This basically means you can use this code however you want for
 * free, but don't claim to have written it yourself!
 * Donations always accepted: http://www.JavascriptToolbox.com/donate/
 *
 * Please do not link to the .js files on javascripttoolbox.com from
 * your site. Copy the files locally to your server instead.
 *
 */

Date.$VERSION=1.02,Date.LZ=function(e){return(e<0||e>9?"":"0")+e},Date.monthNames=new Array("January","February","March","April","May","June","July","August","September","October","November","December"),Date.monthAbbreviations=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),Date.dayNames=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"),Date.dayAbbreviations=new Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat"),Date.preferAmericanFormat=!0,Date.prototype.getFullYear||(Date.prototype.getFullYear=function(){var e=this.getYear();return e<1900?e+1900:e}),Date.parseString=function(e,t){if(typeof t=="undefined"||t==null||t==""){var n=new Array("y-M-d","MMM d, y","MMM d,y","y-MMM-d","d-MMM-y","MMM d","MMM-d","d-MMM"),r=new Array("M/d/y","M-d-y","M.d.y","M/d","M-d"),i=new Array("d/M/y","d-M-y","d.M.y","d/M","d-M"),s=new Array(n,Date.preferAmericanFormat?r:i,Date.preferAmericanFormat?i:r);for(var o=0;o<s.length;o++){var u=s[o];for(var a=0;a<u.length;a++){var f=Date.parseString(e,u[a]);if(f!=null)return f}}return null}this.isInteger=function(e){for(var t=0;t<e.length;t++)if("1234567890".indexOf(e.charAt(t))==-1)return!1;return!0},this.getInt=function(e,t,n,r){for(var i=r;i>=n;i--){var s=e.substring(t,t+i);if(s.length<n)return null;if(this.isInteger(s))return s}return null},e+="",t+="";var l=0,c=0,h="",p="",d="",v,m,g=(new Date).getFullYear(),y=1,b=1,w=0,E=0,S=0,x="";while(c<t.length){h=t.charAt(c),p="";while(t.charAt(c)==h&&c<t.length)p+=t.charAt(c++);if(p=="yyyy"||p=="yy"||p=="y"){p=="yyyy"&&(v=4,m=4),p=="yy"&&(v=2,m=2),p=="y"&&(v=2,m=4),g=this.getInt(e,l,v,m);if(g==null)return null;l+=g.length,g.length==2&&(g>70?g=1900+(g-0):g=2e3+(g-0))}else if(p=="MMM"||p=="NNN"){y=0;var T=p=="MMM"?Date.monthNames.concat(Date.monthAbbreviations):Date.monthAbbreviations;for(var o=0;o<T.length;o++){var N=T[o];if(e.substring(l,l+N.length).toLowerCase()==N.toLowerCase()){y=o%12+1,l+=N.length;break}}if(y<1||y>12)return null}else if(p=="EE"||p=="E"){var T=p=="EE"?Date.dayNames:Date.dayAbbreviations;for(var o=0;o<T.length;o++){var C=T[o];if(e.substring(l,l+C.length).toLowerCase()==C.toLowerCase()){l+=C.length;break}}}else if(p=="MM"||p=="M"){y=this.getInt(e,l,p.length,2);if(y==null||y<1||y>12)return null;l+=y.length}else if(p=="dd"||p=="d"){b=this.getInt(e,l,p.length,2);if(b==null||b<1||b>31)return null;l+=b.length}else if(p=="hh"||p=="h"){w=this.getInt(e,l,p.length,2);if(w==null||w<1||w>12)return null;l+=w.length}else if(p=="HH"||p=="H"){w=this.getInt(e,l,p.length,2);if(w==null||w<0||w>23)return null;l+=w.length}else if(p=="KK"||p=="K"){w=this.getInt(e,l,p.length,2);if(w==null||w<0||w>11)return null;l+=w.length,w++}else if(p=="kk"||p=="k"){w=this.getInt(e,l,p.length,2);if(w==null||w<1||w>24)return null;l+=w.length,w--}else if(p=="mm"||p=="m"){E=this.getInt(e,l,p.length,2);if(E==null||E<0||E>59)return null;l+=E.length}else if(p=="ss"||p=="s"){S=this.getInt(e,l,p.length,2);if(S==null||S<0||S>59)return null;l+=S.length}else if(p=="a"){if(e.substring(l,l+2).toLowerCase()=="am")x="AM";else{if(e.substring(l,l+2).toLowerCase()!="pm")return null;x="PM"}l+=2}else{if(e.substring(l,l+p.length)!=p)return null;l+=p.length}}if(l!=e.length)return null;if(y==2)if(g%4==0&&g%100!=0||g%400==0){if(b>29)return null}else if(b>28)return null;if(y==4||y==6||y==9||y==11)if(b>30)return null;return w<12&&x=="PM"?w=w-0+12:w>11&&x=="AM"&&(w-=12),new Date(g,y-1,b,w,E,S)},Date.isValid=function(e,t){return Date.parseString(e,t)!=null},Date.prototype.isBefore=function(e){return e==null?!1:this.getTime()<e.getTime()},Date.prototype.isAfter=function(e){return e==null?!1:this.getTime()>e.getTime()},Date.prototype.equals=function(e){return e==null?!1:this.getTime()==e.getTime()},Date.prototype.equalsIgnoreTime=function(e){if(e==null)return!1;var t=(new Date(this.getTime())).clearTime(),n=(new Date(e.getTime())).clearTime();return t.getTime()==n.getTime()},Date.prototype.format=function(e){e+="";var t="",n=0,r="",i="",s=this.getYear()+"",o=this.getMonth()+1,u=this.getDate(),a=this.getDay(),f=this.getHours(),l=this.getMinutes(),c=this.getSeconds(),h,p,d,v,m,g,y,b,w,E,S,f,x,T,N,C,k=new Object;s.length<4&&(s=""+(+s+1900)),k.y=""+s,k.yyyy=s,k.yy=s.substring(2,4),k.M=o,k.MM=Date.LZ(o),k.MMM=Date.monthNames[o-1],k.NNN=Date.monthAbbreviations[o-1],k.d=u,k.dd=Date.LZ(u),k.E=Date.dayAbbreviations[a],k.EE=Date.dayNames[a],k.H=f,k.HH=Date.LZ(f),f==0?k.h=12:f>12?k.h=f-12:k.h=f,k.hh=Date.LZ(k.h),k.K=k.h-1,k.k=k.H+1,k.KK=Date.LZ(k.K),k.kk=Date.LZ(k.k),f>11?k.a="PM":k.a="AM",k.m=l,k.mm=Date.LZ(l),k.s=c,k.ss=Date.LZ(c);while(n<e.length){r=e.charAt(n),i="";while(e.charAt(n)==r&&n<e.length)i+=e.charAt(n++);typeof k[i]!="undefined"?t+=k[i]:t+=i}return t},Date.prototype.getDayName=function(){return Date.dayNames[this.getDay()]},Date.prototype.getDayAbbreviation=function(){return Date.dayAbbreviations[this.getDay()]},Date.prototype.getMonthName=function(){return Date.monthNames[this.getMonth()]},Date.prototype.getMonthAbbreviation=function(){return Date.monthAbbreviations[this.getMonth()]},Date.prototype.clearTime=function(){return this.setHours(0),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),this},Date.prototype.add=function(e,t){if(typeof e=="undefined"||e==null||typeof t=="undefined"||t==null)return this;t=+t;if(e=="y")this.setFullYear(this.getFullYear()+t);else if(e=="M")this.setMonth(this.getMonth()+t);else if(e=="d")this.setDate(this.getDate()+t);else if(e=="w"){var n=t>0?1:-1;while(t!=0){this.add("d",n);while(this.getDay()==0||this.getDay()==6)this.add("d",n);t-=n}}else e=="h"?this.setHours(this.getHours()+t):e=="m"?this.setMinutes(this.getMinutes()+t):e=="s"&&this.setSeconds(this.getSeconds()+t);return this};