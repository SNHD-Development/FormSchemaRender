/*!
 * jQuery Tools v1.2.7 - The missing UI library for the Web
 *
 * overlay/overlay.js
 * overlay/overlay.apple.js
 *
 * NO COPYRIGHTS OR LICENSES. DO WHAT YOU LIKE.
 *
 * http://flowplayer.org/tools/
 *
 */

!function(e){function t(t,i){var s,r,l,a=this,c=t.add(a),f=e(window),d=e.tools.expose&&(i.mask||i.expose),u=Math.random().toString().slice(10);d&&("string"==typeof d&&(d={color:d}),d.closeOnClick=d.closeOnEsc=!1);var p=i.target||t.attr("rel");if(r=p?e(p):t,!r.length)throw"Could not find Overlay: "+p;t&&t.index(r)==-1&&t.click(function(e){return a.load(e),e.preventDefault()}),e.extend(a,{load:function(t){if(a.isOpened())return a;var s=n[i.effect];if(!s)throw'Overlay: cannot find effect : "'+i.effect+'"';if(i.oneInstance&&e.each(o,function(){this.close(t)}),t=t||e.Event(),t.type="onBeforeLoad",c.trigger(t),t.isDefaultPrevented())return a;l=!0,d&&e(r).expose(d);var p=i.top,g=i.left,h=r.outerWidth({margin:!0}),v=r.outerHeight({margin:!0});return"string"==typeof p&&(p="center"==p?Math.max((f.height()-v)/2,0):parseInt(p,10)/100*f.height()),"center"==g&&(g=Math.max((f.width()-h)/2,0)),s[0].call(a,{top:p,left:g},function(){l&&(t.type="onLoad",c.trigger(t))}),d&&i.closeOnClick&&e.mask.getMask().one("click",a.close),i.closeOnClick&&e(document).on("click."+u,function(t){e(t.target).parents(r).length||a.close(t)}),i.closeOnEsc&&e(document).on("keydown."+u,function(e){27==e.keyCode&&a.close(e)}),a},close:function(t){return a.isOpened()?(t=t||e.Event(),t.type="onBeforeClose",c.trigger(t),t.isDefaultPrevented()?void 0:(l=!1,n[i.effect][1].call(a,function(){t.type="onClose",c.trigger(t)}),e(document).off("click."+u+" keydown."+u),d&&e.mask.close(),a)):a},getOverlay:function(){return r},getTrigger:function(){return t},getClosers:function(){return s},isOpened:function(){return l},getConf:function(){return i}}),e.each("onBeforeLoad,onStart,onLoad,onBeforeClose,onClose".split(","),function(t,o){e.isFunction(i[o])&&e(a).on(o,i[o]),a[o]=function(t){return t&&e(a).on(o,t),a}}),s=r.find(i.close||".close"),!s.length&&!i.close&&(s=e('<a class="close"></a>'),r.prepend(s)),s.click(function(e){a.close(e)}),i.load&&a.load()}e.tools=e.tools||{version:"v1.2.7"},e.tools.overlay={addEffect:function(e,t,o){n[e]=[t,o]},conf:{close:null,closeOnClick:!0,closeOnEsc:!0,closeSpeed:"fast",effect:"default",fixed:!e.browser.msie||e.browser.version>6,left:"center",load:!1,mask:null,oneInstance:!0,speed:"normal",target:null,top:"10%"}};var o=[],n={};e.tools.overlay.addEffect("default",function(t,o){var n=this.getConf(),i=e(window);n.fixed||(t.top+=i.scrollTop(),t.left+=i.scrollLeft()),t.position=n.fixed?"fixed":"absolute",this.getOverlay().css(t).fadeIn(n.speed,o)},function(e){this.getOverlay().fadeOut(this.getConf().closeSpeed,e)}),e.fn.overlay=function(n){var i=this.data("overlay");return i?i:(e.isFunction(n)&&(n={onBeforeLoad:n}),n=e.extend(!0,{},e.tools.overlay.conf,n),this.each(function(){i=new t(e(this),n),o.push(i),e(this).data("overlay",i)}),n.api?i:this)}}(jQuery),function(e){function t(e){var t=e.offset();return{top:t.top+e.height()/2,left:t.left+e.width()/2}}var o=e.tools.overlay,n=e(window);e.extend(o.conf,{start:{top:null,left:null},fadeInSpeed:"fast",zIndex:9999});var i=function(o,i){var s=this.getOverlay(),r=this.getConf(),l=this.getTrigger(),a=this,c=s.outerWidth({margin:!0}),f=s.data("img"),d=r.fixed?"fixed":"absolute";if(!f){var u=s.css("backgroundImage");if(!u)throw"background-image CSS property not set for overlay";u=u.slice(u.indexOf("(")+1,u.indexOf(")")).replace(/\"/g,""),s.css("backgroundImage","none"),f=e('<img src="'+u+'"/>'),f.css({border:0,display:"none"}).width(c),e("body").append(f),s.data("img",f)}var p=r.start.top||Math.round(n.height()/2),g=r.start.left||Math.round(n.width()/2);if(l){var h=t(l);p=h.top,g=h.left}r.fixed?(p-=n.scrollTop(),g-=n.scrollLeft()):(o.top+=n.scrollTop(),o.left+=n.scrollLeft()),f.css({position:"absolute",top:p,left:g,width:0,zIndex:r.zIndex}).show(),o.position=d,s.css(o),f.animate({top:o.top,left:o.left,width:c},r.speed,function(){s.css("zIndex",r.zIndex+1).fadeIn(r.fadeInSpeed,function(){a.isOpened()&&!e(this).index(s)?i.call():s.hide()})}).css("position",d)},s=function(o){var i=this.getOverlay().hide(),s=this.getConf(),r=this.getTrigger(),l=i.data("img"),a={top:s.start.top,left:s.start.left,width:0};r&&e.extend(a,t(r)),s.fixed&&l.css({position:"absolute"}).animate({top:"+="+n.scrollTop(),left:"+="+n.scrollLeft()},0),l.animate(a,s.closeSpeed,o)};o.addEffect("apple",i,s)}(jQuery);