define(["jquery","lodash","backbone","vm","utils","events","modelbinder","validation","views/baseField","text!templates/form-layouts/default.html"],function(e,t,n,r,i,s,o,u,a,f){var l=a.extend({_modelBinder:undefined,template:t.template(f),initialize:function(){a.prototype.initialize.call(this);if(typeof this.options.formSchema=="undefined")throw"formSchema is not in the options parameters";this.el="#"+this.options.formSchema.name},render:function(){var r=this,s,o=a.prototype.render,u="",f=[];t.each(this.options.formSchema.fields,function(e,n,l){var c="",h=e.type.toLowerCase();if(!a.prototype.checkShowOnMode.call(r,e,r.options.mode,r.options.formData.status))return"";r.options.internal&&typeof e.options.internalcanupdate!="undefined"&&!e.options.internalcanupdate?h==="image"&&(s=i.checkRequireFields(e,r.options.formSchema.validation),c+=r.renderLabel(e,s)):typeof e.description!="undefined"&&t.indexOf(r.notRenderLabel,h)===-1&&(s=i.checkRequireFields(e,r.options.formSchema.validation),c+=r.renderLabel(e,s)),c+=o.call(r,e),r.options.mode==="create"&&e.options.copyvaluesfrom&&(u+=a.prototype.setupCopyValuesFrom.call(r,e)),e.options.visibleon&&h!=="button"&&h!=="submit"?(c='<div class="options-visible-on-'+e.name+'" style="display:none">'+c+"</div>",f.unshift({value:e,html:c})):u+=c}),t.each(f,function(e){a.prototype.setupVisibleOn.call(r,e.value,e.html)}),u+=a.prototype.closeOpenDiv.call(this),e(this.el).html(this.template(t.extend({html:u},this.options.formSchema))),r._modelBinder.bind(r.model,r.el,r.model.bindings),n.Validation.bind(r,{forceUpdate:!0})}});return l});